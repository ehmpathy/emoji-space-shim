/**
 * .what = checks coverage of FE0F emojis against Unicode source
 * .why = identifies any gaps in the registry
 *
 * usage: npx tsx src/__test_assets__/checkCoverage.ts
 */

import { EMOJI_SPACE_REGISTRY } from '../domain.objects/EmojiSpaceRegistry';

// all FE0F variation sequence base codepoints from Unicode 16.0
// source: https://unicode.org/Public/16.0.0/ucd/emoji/emoji-variation-sequences.txt
const fe0fCodepoints = [
  0x0023, 0x002a, 0x0030, 0x0031, 0x0032, 0x0033, 0x0034, 0x0035, 0x0036,
  0x0037, 0x0038, 0x0039, 0x00a9, 0x00ae, 0x203c, 0x2049, 0x2122, 0x2139,
  0x2194, 0x2195, 0x2196, 0x2197, 0x2198, 0x2199, 0x21a9, 0x21aa, 0x231a,
  0x231b, 0x2328, 0x23cf, 0x23e9, 0x23ea, 0x23eb, 0x23ec, 0x23ed, 0x23ee,
  0x23ef, 0x23f0, 0x23f1, 0x23f2, 0x23f3, 0x23f8, 0x23f9, 0x23fa, 0x24c2,
  0x25aa, 0x25ab, 0x25b6, 0x25c0, 0x25fb, 0x25fc, 0x25fd, 0x25fe, 0x2600,
  0x2601, 0x2602, 0x2603, 0x2604, 0x260e, 0x2611, 0x2614, 0x2615, 0x2618,
  0x261d, 0x2620, 0x2622, 0x2623, 0x2626, 0x262a, 0x262e, 0x262f, 0x2638,
  0x2639, 0x263a, 0x2640, 0x2642, 0x2648, 0x2649, 0x264a, 0x264b, 0x264c,
  0x264d, 0x264e, 0x264f, 0x2650, 0x2651, 0x2652, 0x2653, 0x265f, 0x2660,
  0x2663, 0x2665, 0x2666, 0x2668, 0x267b, 0x267e, 0x267f, 0x2692, 0x2693,
  0x2694, 0x2695, 0x2696, 0x2697, 0x2699, 0x269b, 0x269c, 0x26a0, 0x26a1,
  0x26a7, 0x26aa, 0x26ab, 0x26b0, 0x26b1, 0x26bd, 0x26be, 0x26c4, 0x26c5,
  0x26c8, 0x26ce, 0x26cf, 0x26d1, 0x26d3, 0x26d4, 0x26e9, 0x26ea, 0x26f0,
  0x26f1, 0x26f2, 0x26f3, 0x26f4, 0x26f5, 0x26f7, 0x26f8, 0x26f9, 0x26fa,
  0x26fd, 0x2702, 0x2705, 0x2708, 0x2709, 0x270a, 0x270b, 0x270c, 0x270d,
  0x270f, 0x2712, 0x2714, 0x2716, 0x271d, 0x2721, 0x2728, 0x2733, 0x2734,
  0x2744, 0x2747, 0x274c, 0x274e, 0x2753, 0x2754, 0x2755, 0x2757, 0x2763,
  0x2764, 0x2795, 0x2796, 0x2797, 0x27a1, 0x27b0, 0x27bf, 0x2934, 0x2935,
  0x2b05, 0x2b06, 0x2b07, 0x2b1b, 0x2b1c, 0x2b50, 0x2b55, 0x3030, 0x303d,
  0x3297, 0x3299,
  // 1F range
  0x1f004, 0x1f170, 0x1f171, 0x1f17e, 0x1f17f, 0x1f202, 0x1f21a, 0x1f22f,
  0x1f237, 0x1f30d, 0x1f30e, 0x1f30f, 0x1f315, 0x1f31c, 0x1f321, 0x1f324,
  0x1f325, 0x1f326, 0x1f327, 0x1f328, 0x1f329, 0x1f32a, 0x1f32b, 0x1f32c,
  0x1f336, 0x1f378, 0x1f37d, 0x1f393, 0x1f396, 0x1f397, 0x1f399, 0x1f39a,
  0x1f39b, 0x1f39e, 0x1f39f, 0x1f3a7, 0x1f3ac, 0x1f3ad, 0x1f3ae, 0x1f3c2,
  0x1f3c4, 0x1f3c6, 0x1f3ca, 0x1f3cb, 0x1f3cc, 0x1f3cd, 0x1f3ce, 0x1f3d4,
  0x1f3d5, 0x1f3d6, 0x1f3d7, 0x1f3d8, 0x1f3d9, 0x1f3da, 0x1f3db, 0x1f3dc,
  0x1f3dd, 0x1f3de, 0x1f3df, 0x1f3e0, 0x1f3ed, 0x1f3f3, 0x1f3f5, 0x1f3f7,
  0x1f408, 0x1f415, 0x1f41f, 0x1f426, 0x1f43f, 0x1f441, 0x1f442, 0x1f446,
  0x1f447, 0x1f448, 0x1f449, 0x1f44d, 0x1f44e, 0x1f453, 0x1f46a, 0x1f47d,
  0x1f4a3, 0x1f4b0, 0x1f4b3, 0x1f4bb, 0x1f4bf, 0x1f4cb, 0x1f4da, 0x1f4df,
  0x1f4e4, 0x1f4e5, 0x1f4e6, 0x1f4ea, 0x1f4eb, 0x1f4ec, 0x1f4ed, 0x1f4f7,
  0x1f4f9, 0x1f4fa, 0x1f4fb, 0x1f4fd, 0x1f508, 0x1f50d, 0x1f512, 0x1f513,
  0x1f549, 0x1f54a, 0x1f550, 0x1f551, 0x1f552, 0x1f553, 0x1f554, 0x1f555,
  0x1f556, 0x1f557, 0x1f558, 0x1f559, 0x1f55a, 0x1f55b, 0x1f55c, 0x1f55d,
  0x1f55e, 0x1f55f, 0x1f560, 0x1f561, 0x1f562, 0x1f563, 0x1f564, 0x1f565,
  0x1f566, 0x1f567, 0x1f56f, 0x1f570, 0x1f573, 0x1f574, 0x1f575, 0x1f576,
  0x1f577, 0x1f578, 0x1f579, 0x1f587, 0x1f58a, 0x1f58b, 0x1f58c, 0x1f58d,
  0x1f590, 0x1f5a5, 0x1f5a8, 0x1f5b1, 0x1f5b2, 0x1f5bc, 0x1f5c2, 0x1f5c3,
  0x1f5c4, 0x1f5d1, 0x1f5d2, 0x1f5d3, 0x1f5dc, 0x1f5dd, 0x1f5de, 0x1f5e1,
  0x1f5e3, 0x1f5e8, 0x1f5ef, 0x1f5f3, 0x1f5fa, 0x1f610, 0x1f687, 0x1f68d,
  0x1f691, 0x1f694, 0x1f698, 0x1f6ad, 0x1f6b2, 0x1f6b9, 0x1f6ba, 0x1f6bc,
  0x1f6cb, 0x1f6cd, 0x1f6ce, 0x1f6cf, 0x1f6e0, 0x1f6e1, 0x1f6e2, 0x1f6e3,
  0x1f6e4, 0x1f6e5, 0x1f6e9, 0x1f6f0, 0x1f6f3,
];

// Emoji_Presentation=Yes codepoints (these default to emoji - don't need FE0F shim)
// source: https://unicode.org/Public/16.0.0/ucd/emoji/emoji-data.txt
const emojiDefault = new Set([
  0x231a,
  0x231b, // watch, hourglass
  0x23e9,
  0x23ea,
  0x23eb,
  0x23ec,
  0x23f0,
  0x23f3, // fast forward etc
  0x25fd,
  0x25fe, // squares
  0x2614,
  0x2615, // umbrella, coffee
  // zodiac signs 2648-2653
  0x2648,
  0x2649,
  0x264a,
  0x264b,
  0x264c,
  0x264d,
  0x264e,
  0x264f,
  0x2650,
  0x2651,
  0x2652,
  0x2653,
  0x267f, // wheelchair
  0x2693, // anchor
  0x26a1, // high voltage
  0x26aa,
  0x26ab, // circles
  0x26bd,
  0x26be, // sports
  0x26c4,
  0x26c5, // snowman, sun behind cloud
  0x26ce, // ophiuchus
  0x26d4, // no entry
  0x26ea, // church
  0x26f2,
  0x26f3,
  0x26f5, // fountain, golf, sailboat
  0x26fa, // tent
  0x26fd, // fuel pump
  0x2705, // check mark
  0x270a,
  0x270b, // fists
  0x2728, // sparkles
  0x274c,
  0x274e, // x marks
  0x2753,
  0x2754,
  0x2755,
  0x2757, // question/exclamation
  0x2795,
  0x2796,
  0x2797, // plus minus divide
  0x27b0,
  0x27bf, // curly loops
  0x2b1b,
  0x2b1c, // squares
  0x2b50, // star
  0x2b55, // circle
  // 1F range emoji-default
  0x1f004, // mahjong
  0x1f3a7,
  0x1f3ac,
  0x1f3ad,
  0x1f3ae, // headphone, clapper, masks, controller
  0x1f3c2,
  0x1f3c4,
  0x1f3c6,
  0x1f3ca, // sports
  0x1f3e0,
  0x1f3ed, // house, factory
  0x1f408,
  0x1f415,
  0x1f41f,
  0x1f426, // cat, dog, fish, bird
  0x1f442, // ear
  0x1f446,
  0x1f447,
  0x1f448,
  0x1f449, // up, down, left, right
  0x1f44d,
  0x1f44e, // thumbs
  0x1f453, // glasses
  0x1f46a, // family
  0x1f47d, // alien
  0x1f4a3, // bomb
  0x1f4b0,
  0x1f4b3, // money
  0x1f4bb,
  0x1f4bf, // laptop, cd
  0x1f4cb,
  0x1f4da,
  0x1f4df, // clipboard, books, pager
  0x1f4e4,
  0x1f4e5,
  0x1f4e6, // outbox, inbox, package
  0x1f4ea,
  0x1f4eb,
  0x1f4ec,
  0x1f4ed, // mailboxes
  0x1f4f7,
  0x1f4f9,
  0x1f4fa,
  0x1f4fb, // camera, video, tv, radio
  0x1f508,
  0x1f50d,
  0x1f512,
  0x1f513, // speaker, search, locks
  0x1f550,
  0x1f551,
  0x1f552,
  0x1f553,
  0x1f554,
  0x1f555,
  0x1f556,
  0x1f557, // clocks
  0x1f558,
  0x1f559,
  0x1f55a,
  0x1f55b,
  0x1f55c,
  0x1f55d,
  0x1f55e,
  0x1f55f, // clocks
  0x1f560,
  0x1f561,
  0x1f562,
  0x1f563,
  0x1f564,
  0x1f565,
  0x1f566,
  0x1f567, // clocks
  0x1f610, // neutral face
  0x1f687,
  0x1f68d,
  0x1f691,
  0x1f694,
  0x1f698, // metro, bus, ambulance, police, approach
  0x1f6ad,
  0x1f6b2, // no smoke, bicycle
  0x1f6b9,
  0x1f6ba,
  0x1f6bc, // mens, womens, baby
]);

// filter to text-default only (ones that need FE0F for emoji presentation)
const textDefault = fe0fCodepoints.filter((cp) => !emojiDefault.has(cp));

// get all emojis in registry
const registryEmojis = Object.keys(EMOJI_SPACE_REGISTRY);

// check which text-default FE0F emojis are absent from registry
const absentFromRegistry: string[] = [];
for (const cp of textDefault) {
  const emoji = String.fromCodePoint(cp) + '\uFE0F';
  const found = registryEmojis.some((e) =>
    e.startsWith(String.fromCodePoint(cp)),
  );
  if (!found) {
    absentFromRegistry.push(`${emoji} U+${cp.toString(16).toUpperCase()}`);
  }
}

console.log('=== FE0F Coverage Analysis ===');
console.log(`Total FE0F codepoints: ${fe0fCodepoints.length}`);
console.log(`Emoji-default (skip): ${emojiDefault.size}`);
console.log(`Text-default (need shim): ${textDefault.length}`);
console.log(`Absent from registry: ${absentFromRegistry.length}`);
if (absentFromRegistry.length > 0) {
  console.log('\nAbsent emojis:');
  absentFromRegistry.forEach((e) => console.log(`  ${e}`));
}
